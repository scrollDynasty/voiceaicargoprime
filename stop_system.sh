#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ Voice AI —Å–∏—Å—Ç–µ–º—ã
# Prime Cargo Logistics

echo "üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ Voice AI —Å–∏—Å—Ç–µ–º—ã..."
echo "================================"

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞
stop_process() {
    local name=$1
    local pid_file="logs/$name.pid"
    
    if [ -f "$pid_file" ]; then
        PID=$(cat "$pid_file")
        if ps -p $PID > /dev/null 2>&1; then
            echo "‚èπÔ∏è  –û—Å—Ç–∞–Ω–æ–≤–∫–∞ $name (PID: $PID)..."
            kill $PID
            sleep 2
            
            # –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –≤—Å–µ –µ—â–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º SIGKILL
            if ps -p $PID > /dev/null 2>&1; then
                echo "‚ö†Ô∏è  –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ $name..."
                kill -9 $PID
            fi
            
            rm -f "$pid_file"
            echo "‚úÖ $name –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
        else
            echo "‚ÑπÔ∏è  $name –Ω–µ –∑–∞–ø—É—â–µ–Ω (PID —Ñ–∞–π–ª —É—Å—Ç–∞—Ä–µ–ª)"
            rm -f "$pid_file"
        fi
    else
        echo "‚ÑπÔ∏è  $name –Ω–µ –∑–∞–ø—É—â–µ–Ω (PID —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω)"
    fi
}

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

stop_process "python-server"

# –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
echo "üßπ –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤..."
rm -f temp/*.tmp

echo ""
echo "================================"
echo "‚úÖ Voice AI —Å–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
echo "================================"